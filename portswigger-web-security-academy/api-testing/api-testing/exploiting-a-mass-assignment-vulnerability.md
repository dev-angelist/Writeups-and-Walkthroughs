---
description: >-
  https://portswigger.net/web-security/learning-paths/api-testing/api-testing-mass-assignment-vulnerabilities/api-testing/lab-exploiting-mass-assignment-vulnerability
icon: vial
---

# Exploiting a mass assignment vulnerability

## Description

To solve the lab, find and exploit a mass assignment vulnerability to buy a **Lightweight l33t Leather Jacket**. You can log in to your own account using the following credentials: `wiener:peter`.

## Solution

<figure><img src="../../../.gitbook/assets/image (49).png" alt=""><figcaption></figcaption></figure>

Starting login as Wiener user

<figure><img src="../../../.gitbook/assets/image (50).png" alt=""><figcaption></figcaption></figure>

Going to home page there're all articles and the Lightweight l33t Leather Jacket that we should buy, add it to cart.

<figure><img src="../../../.gitbook/assets/image (51).png" alt=""><figcaption></figcaption></figure>

Opening the shop cart, we can see that there're not credits necessary to buy it, infact there's an error message "Not enough store credit for this purchase"

<figure><img src="../../../.gitbook/assets/image (53).png" alt=""><figcaption></figcaption></figure>

Inspecting HTTP request there's an interesting POST request with an API: `/api/checkout` that permits to move product to shopping cart, but we received an "Insufficient Funds" error message:

<figure><img src="../../../.gitbook/assets/image (54).png" alt=""><figcaption></figcaption></figure>

Analyzing GET /api/checkout request we can see that the response contains the item price and a percentage of discount:

<figure><img src="../../../.gitbook/assets/image (55).png" alt=""><figcaption></figcaption></figure>

Trying to change method using POST we can modify the request setting the JSON value and obtain the product fully discounted:

```json
{"chosen_discount":{"percentage":100},
"chosen_products":[{"product_id":"1","quantity":1}]}
```

Now the product desidered muches 0.00$ and we can buy it with store credit solving the lab:

<figure><img src="../../../.gitbook/assets/image (56).png" alt=""><figcaption></figcaption></figure>
