---
description: >-
  https://portswigger.net/web-security/api-testing/lab-exploiting-unused-api-endpoint
icon: vial-virus
---

# Finding and exploiting an unused API endpoint

## Description

To solve the lab, exploit a hidden API endpoint to buy a **Lightweight l33t Leather Jacket**. You can log in to your own account using the following credentials: `wiener:peter`.

## Solution

<figure><img src="../../../.gitbook/assets/image (66) (1).png" alt=""><figcaption></figcaption></figure>

Starting login as Wiener user

<figure><img src="../../../.gitbook/assets/image (67) (1).png" alt=""><figcaption></figcaption></figure>

Going to home page there're all articles and the Lightweight l33t Leather Jacket that we should buy, add it to cart.

<figure><img src="../../../.gitbook/assets/image (69).png" alt=""><figcaption></figcaption></figure>

Opening the shop cart, we can see that there're not credits necessary to buy it, infact there's an error message "Not enough store credit for this purchase"

<figure><img src="../../../.gitbook/assets/image (70).png" alt=""><figcaption></figcaption></figure>

Inspecting HTTP request there's an interesting GET request with an API: `/api/products/1/price` that permits to visualize product's price in json format:

<figure><img src="../../../.gitbook/assets/image (71).png" alt=""><figcaption></figcaption></figure>

Trying to change method using POST we receive an error message: "Method Not Allowed" and the methods allowed are ony: GET (already used) and PATCH.

<figure><img src="../../../.gitbook/assets/image (72).png" alt=""><figcaption></figcaption></figure>

This time we use PATCH method and we receive an error: "Only 'application/json' Content-Type is supported", so we need to request a json value

<figure><img src="../../../.gitbook/assets/image (73).png" alt=""><figcaption></figcaption></figure>

Adding  Content-Type: application/json and price that we want: 0.00$ we're able to set price:

```json
Content-Type: application/json

{
	"price": 0
}
```

<figure><img src="../../../.gitbook/assets/image (74).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (75).png" alt=""><figcaption></figcaption></figure>

Now the product desidered muches 0.00$ and we can buy it with store credit solving the lab:

<figure><img src="../../../.gitbook/assets/image (76).png" alt=""><figcaption></figcaption></figure>
